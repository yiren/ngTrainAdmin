<form [formGroup]="studentSearchForm" (ngSubmit)="onSubmit()">
    <p>
        <mat-form-field>
            <input matInput placeholder="請輸入學員名字" aria-label="State" [matAutocomplete]="auto" formControlName="studentName">
            <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let student of filteredStudents | async" [value]="student.studentName">
                    {{student.studentName}}
                </mat-option>
            </mat-autocomplete>
        </mat-form-field>
    </p>


    <mat-form-field>
        <input matInput [matDatepicker]="startDate" placeholder="開訓日期" formControlName="courseStartDate">
        <mat-datepicker-toggle matSuffix [for]="startDate"></mat-datepicker-toggle>
        <mat-datepicker #startDate disabled="false"></mat-datepicker>
    </mat-form-field>
    /
    <mat-form-field>
        <input matInput [matDatepicker]="endDate" placeholder="結訓日期" formControlName="courseEndDate">
        <mat-datepicker-toggle matSuffix [for]="endDate"></mat-datepicker-toggle>
        <mat-datepicker #endDate disabled="false"></mat-datepicker>
    </mat-form-field>

    <p>
        <button mat-raised-button color="primary" type="submit" [disabled]="!studentSearchForm.valid">搜尋學員訓練紀錄</button>
        <button mat-raised-button type="reset" (click)="reset()">清空搜尋</button>
        <button mat-raised-button color="accent" (click)="excelexport.save()" [disabled]="!isSubmitted">匯出搜尋結果</button>
    </p>

</form>
<kendo-excelexport [data]="searchData" fileName="訓練課程搜尋結果.xlsx" #excelexport>
    <kendo-excelexport-column field="sectionName" title="組別">
    </kendo-excelexport-column>
    <kendo-excelexport-column field="studentName" title="學員">
    </kendo-excelexport-column>
    <kendo-excelexport-column field="courseName" title="課程名稱">
    </kendo-excelexport-column>
    <kendo-excelexport-column field="trainHours" title="訓練時數">
    </kendo-excelexport-column>
    <kendo-excelexport-column field="score" title="分數">
    </kendo-excelexport-column>
    <kendo-excelexport-column field="courseStartDate" title="開訓日期">
    </kendo-excelexport-column>
    <kendo-excelexport-column field="courseEndDate" title="結訓日期">
    </kendo-excelexport-column>
</kendo-excelexport>